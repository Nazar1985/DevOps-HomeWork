# Курсовая работа по итогам модуля "DevOps и системное администрирование"

Курсовая работа необходима для проверки практических навыков, полученных в ходе прохождения курса "DevOps и системное администрирование".

Мы создадим и настроим виртуальное рабочее место. Позже вы сможете использовать эту систему для выполнения домашних заданий по курсу

## Задание

1. Создайте виртуальную машину Linux.
2. Установите ufw и разрешите к этой машине сессии на порты 22 и 443, 
при этом трафик на интерфейсе localhost (lo) должен ходить свободно на все порты.

3. Установите hashicorp vault ([инструкция по ссылке](https://learn.hashicorp.com/tutorials/vault/getting-started-install?in=vault/getting-started#install-vault)).
4. Cоздайте центр сертификации по инструкции ([ссылка](https://learn.hashicorp.com/tutorials/vault/pki-engine?in=vault/secrets-management)) и выпустите сертификат для использования его в настройке веб-сервера nginx (срок жизни сертификата - месяц).
5. Установите корневой сертификат созданного центра сертификации в доверенные в хостовой системе.
6. Установите nginx.
7. По инструкции ([ссылка](https://nginx.org/en/docs/http/configuring_https_servers.html)) настройте nginx на https, используя ранее подготовленный сертификат:
  - можно использовать стандартную стартовую страницу nginx для демонстрации работы сервера;
  - можно использовать и другой html файл, сделанный вами;
8. Откройте в браузере на хосте https адрес страницы, которую обслуживает сервер nginx.
9. Создайте скрипт, который будет генерировать новый сертификат в vault:
  - генерируем новый сертификат так, чтобы не переписывать конфиг nginx;
  - перезапускаем nginx для применения нового сертификата.
10. Поместите скрипт в crontab, чтобы сертификат обновлялся какого-то числа каждого месяца в удобное для вас время.

## Результат

Результатом курсовой работы должны быть снимки экрана или текст:

###### Поднимем сервер  

![](Screenshot from 2022-05-15 02-05-00.png)

- Процесс установки и настройки ufw

![](Screenshot from 2022-05-15 02-09-58.png)
![](Screenshot from 2022-05-14 14-50-42.png)

- Процесс установки и выпуска сертификата с помощью hashicorp vault
###### подключаем репозиторий для установки vault
![](Screenshot from 2022-05-15 02-11-36.png)
###### устанавливаем vault
![](Screenshot from 2022-05-15 02-14-20.png)
###### устанавливаем утилиту jq для обработки json
![](Screenshot from 2022-05-15 02-14-25.png)
###### запускаем server vault в другом сеансе 
![](Screenshot from 2022-05-15 02-17-05.png)
![](Screenshot from 2022-05-15 02-17-12.png)
###### Экспортируем переменные и создаем корневой центр и промежуточный центр сертификации
![](Screenshot from 2022-05-15 02-19-34.png)
![](Screenshot from 2022-05-15 02-23-17.png)
###### создаем роль и запрашиваем новый сертификат
![](Screenshot from 2022-05-15 02-26-28.png)
###### Преобразовываем сертификаты (переименовываем файлы). 
![](Screenshot from 2022-05-15 02-29-28.png)
###### копируем через папку `/vagrant/` гостевой системы файлы сертификата хостовую систему и обновляем хранилище сертификатов хостовой системы
![](Screenshot from 2022-05-15 02-41-15.png)

- Процесс установки и настройки сервера nginx

![](Screenshot from 2022-05-15 03-45-39.png)
![](Screenshot from 2022-05-15 03-46-33.png)
![](Screenshot from 2022-05-15 04-34-19.png)
![](Screenshot from 2022-05-15 19-43-06.png)

- Страница сервера nginx в браузере хоста не содержит предупреждений 

![](Screenshot from 2022-05-14 22-39-08.png)
![](Screenshot from 2022-05-15 04-37-44.png)
![](Screenshot from 2022-05-15 04-37-46.png)

- Скрипт генерации нового сертификата работает (сертификат сервера ngnix должен быть "зеленым")

![](Screenshot from 2022-05-15 05-27-19.png)
![](Screenshot from 2022-05-15 05-27-23.png)
![](Screenshot from 2022-05-15 05-27-55.png)
![](Screenshot from 2022-05-15 05-30-10.png)


- Crontab работает (выберите число и время так, чтобы показать что crontab запускается и делает что надо)

![](Screenshot from 2022-05-15 19-28-52.png)
